<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PreLaunchIQ – Validate Without Website</title>
  <meta name="description" content="Validate your SaaS idea using real forum data, urgency scoring, and competitor insights—even without a website.">
  <link href="https://fonts.googleapis.com/css2?family=Epilogue:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    :root {
      --primary: #0F766E;
      --primary-light: #14B8A6;
      --primary-dark: #134E4A;
      --accent: #F59E0B;
      --text-dark: #1F2937;
      --text-medium: #4B5563;
      --bg-white: #FFFFFF;
      --bg-light: #F9FAFB;
      --border: #E5E7EB;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Epilogue', sans-serif;
      background: var(--bg-white);
      color: var(--text-dark);
      line-height: 1.6;
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
    }
    .logo {
      font-size: 24px;
      font-weight: 800;
      color: var(--primary);
      margin: 20px 0 40px;
      text-align: center;
    }
    .logo-accent { color: var(--accent); }
    h1, h2, h3 {
      margin-bottom: 16px;
      line-height: 1.3;
    }
    h1 { font-size: 28px; }
    h2 { font-size: 22px; color: var(--primary); }
    .section {
      background: var(--bg-white);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 32px;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .section.visible {
      opacity: 1;
      transform: translateY(0);
    }
    textarea {
      width: 100%;
      height: 120px;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-family: inherit;
      margin-bottom: 16px;
    }
    button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }
    button:hover { background: var(--primary-dark); }
    .post-item {
      background: var(--bg-light);
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 12px;
      font-size: 14px;
    }
    .side-by-side {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-top: 20px;
    }
    @media (max-width: 768px) {
      .side-by-side { grid-template-columns: 1fr; }
    }
    .panel-title {
      font-weight: 700;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--primary);
    }
    .human { background: #F0FDFA; padding: 16px; border-radius: 8px; }
    .ai { background: #FEF3C7; padding: 16px; border-radius: 8px; }
    .score-display {
      font-size: 36px;
      font-weight: 800;
      color: var(--primary);
      text-align: center;
      margin: 20px 0;
    }
    .download-btn {
      display: block;
      margin: 30px auto;
      padding: 14px 32px;
      background: var(--accent);
      color: #000;
      font-weight: 700;
      border-radius: 10px;
    }
    #report-content { display: none; }
  </style>
</head>
<body>
  <div class="logo">PreLaunch<span class="logo-accent">IQ</span></div>

  <!-- Input Section -->
  <div id="input-section" class="section visible">
    <h1>Describe Your SaaS Idea</h1>
    <p>We’ll analyze real discussions to validate demand—even without a website.</p>
    <textarea id="ideaInput" placeholder="e.g., A tool that helps indie hackers validate SaaS ideas using Hacker News and Reddit data..."></textarea>
    <button onclick="startValidation()">Start Validation</button>
  </div>

  <!-- Real Discussions (appears after 2s) -->
  <div id="discussions-section" class="section">
    <h2>Real People Talking About This Problem</h2>
    <div id="discussions-list"></div>
  </div>

  <!-- Human vs AI (after 5s) -->
  <div id="thinking-section" class="section">
    <h2>Human Thinking vs AI Thinking</h2>
    <div class="side-by-side">
      <div class="human">
        <div class="panel-title">Human Thinking</div>
        <div id="human-thinking">People are frustrated with existing tools. They say: “I wasted 4 months building something nobody wanted.” Many ask: “Is there a way to validate before coding?”</div>
      </div>
      <div class="ai">
        <div class="panel-title">AI Thinking</div>
        <div id="ai-thinking">High emotional intensity in discussions suggests urgent need. Gap: no tool combines real-time demand validation with technical testing. Opportunity: position as “pre-launch co-pilot” for indie hackers.</div>
      </div>
    </div>
  </div>

  <!-- Launch Need Score (after 15s) -->
  <div id="score-section" class="section">
    <h2>Launch Need Score</h2>
    <div class="score-display" id="urgency-score">8.4 / 10</div>
    <p>This score reflects real demand intensity, conversation frequency, and solution gaps found across public forums.</p>
  </div>

  <!-- Competitor Analysis (after 30s) -->
  <div id="competitor-section" class="section">
    <h2>Competitor Gaps & Your Edge</h2>
    <ul>
      <li><strong>ValidateBot</strong>: Good UI, but only uses AI guesses—no real forum data.</li>
      <li><strong>IdeaCheck Pro</strong>: Analyzes competitors, but ignores user pain signals from communities.</li>
    </ul>
    <p><strong>Your Opportunity:</strong> Combine real human frustration + AI insight + technical readiness in one report—something no one offers today.</p>
  </div>

  <!-- Target Audience (after 45s) -->
  <div id="audience-section" class="section">
    <h2>Target Audience</h2>
    <ol>
      <li><strong>Indie Hackers</strong> – Solo founders building side projects who fear wasting time.</li>
      <li><strong>Early-Stage SaaS Founders</strong> – Pre-revenue teams needing validation before fundraising.</li>
      <li><strong>Product Managers</strong> – At small startups validating new feature ideas.</li>
    </ol>
    <p>They care because they’ve been burned before. They want proof—not guesses.</p>
    <button class="download-btn" onclick="downloadReport()">Download Full Report (PDF)</button>
  </div>

  <!-- Hidden for PDF -->
  <div id="report-content">
    <h1>PreLaunchIQ Validation Report</h1>
    <p><strong>Idea:</strong> <span id="pdf-idea">[User idea]</span></p>
    <h2>Launch Need Score: 8.4/10</h2>
    <h2>Target Audience</h2>
    <ol><li>Indie Hackers</li><li>Early-Stage SaaS Founders</li><li>Product Managers</li></ol>
  </div>
  <script>
    function showSection(id) {
      document.getElementById(id).classList.add('visible');
    }
  
    async function startValidation() {
      const idea = document.getElementById('ideaInput').value.trim();
      if (!idea) { alert('Please enter an idea'); return; }
      document.getElementById('pdf-idea').textContent = idea;
      document.getElementById('input-section').style.display = 'none';
  
      try {
        // ✅ This works because of your binding: /api/validate → prebuiltiq
        const res = await fetch('/api/validate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ idea })
        });
        const data = await res.json();
  
        if (data.error) throw new Error(data.error);
  
        // Populate discussions
        const discussionsHtml = (data.discussions || []).map(d => 
          `<div class="post-item"><strong>${d.source}</strong> • ${d.date}<br>${d.title || d.text}</div>`
        ).join('');
        document.getElementById('discussions-list').innerHTML = discussionsHtml;
  
        document.getElementById('human-thinking').textContent = data.humanThinking || "";
        document.getElementById('ai-thinking').textContent = data.aiThinking || "";
        document.getElementById('urgency-score').textContent = (data.urgencyScore || 7.5).toFixed(1) + ' / 10';
  
        const gaps = data.competitorGaps || [];
        document.querySelector('#competitor-section ul').innerHTML = gaps.map(g => `<li>${g}</li>`).join('');
  
        const audience = data.targetAudience || [];
        document.querySelector('#audience-section ol').innerHTML = audience.map(a => 
          `<li><strong>${a}</strong></li>`
        ).join('');
  
        // Reveal sections
        setTimeout(() => showSection('thinking-section'), 1000);
        setTimeout(() => showSection('score-section'), 3000);
        setTimeout(() => showSection('competitor-section'), 5000);
        setTimeout(() => showSection('audience-section'), 7000);
  
      } catch (err) {
        alert('Using demo data (Worker not fully configured yet)');
        // Fallback to static demo (you already have this logic)
        setTimeout(() => {
          document.getElementById('discussions-list').innerHTML = `
            <div class="post-item"><strong>Hacker News</strong> • 2 days ago<br>“How do you validate a SaaS idea before coding?”</div>
            <div class="post-item"><strong>Reddit</strong> • 1 week ago<br>“Spent 6 months building… zero signups.”</div>
          `;
          showSection('discussions-section');
        }, 2000);
        setTimeout(() => showSection('thinking-section'), 5000);
        setTimeout(() => showSection('score-section'), 15000);
        setTimeout(() => showSection('competitor-section'), 30000);
        setTimeout(() => showSection('audience-section'), 45000);
      }
    }
  
    function downloadReport() {
      const element = document.getElementById('report-content');
      const opt = {
        margin: 1,
        filename: 'PreLaunchIQ-Report.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    }
  </script>
  
</body>
</html>
